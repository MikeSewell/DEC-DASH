---
milestone: v1.1
audited: 2026-02-28T16:27:20Z
status: gaps_found
scores:
  requirements: 5/8
  phases: 2/3
  integration: 8/8
  flows: 7/7
gaps:
  requirements:
    - id: "ALRT-03"
      status: "unsatisfied"
      phase: "Phase 7"
      claimed_by_plans: ["07-02-PLAN.md"]
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 07 has no VERIFICATION.md; ALRT-03 not listed in any SUMMARY frontmatter requirements-completed. Integration checker confirms implementation IS wired (WhatNeedsAttention three-ref toast system lines 97-131), but formal verification documentation is absent."
    - id: "ALRT-01"
      status: "partial"
      phase: "Phase 7"
      claimed_by_plans: ["07-01-PLAN.md", "07-02-PLAN.md"]
      completed_by_plans: ["07-01-SUMMARY.md"]
      verification_status: "missing"
      evidence: "Listed in 07-01-SUMMARY requirements-completed frontmatter but Phase 07 has no VERIFICATION.md. Integration checker confirms admin Alerts tab, gear icon, and 5 editable thresholds are all wired."
    - id: "ALRT-02"
      status: "partial"
      phase: "Phase 7"
      claimed_by_plans: ["07-01-PLAN.md", "07-02-PLAN.md"]
      completed_by_plans: ["07-01-SUMMARY.md"]
      verification_status: "missing"
      evidence: "Listed in 07-01-SUMMARY requirements-completed frontmatter but Phase 07 has no VERIFICATION.md. Integration checker confirms dismiss button, getMyDismissals, and visibleAlerts filtering are all wired."
    - id: "DASH-01"
      status: "partial"
      phase: "Phase 5"
      claimed_by_plans: ["05-01-PLAN.md"]
      completed_by_plans: []
      verification_status: "passed"
      evidence: "Phase 05 VERIFICATION.md confirms SATISFIED. Not listed in 05-01-SUMMARY requirements-completed frontmatter (field empty). Implementation verified."
    - id: "DASH-02"
      status: "partial"
      phase: "Phase 5"
      claimed_by_plans: ["05-01-PLAN.md"]
      completed_by_plans: []
      verification_status: "passed"
      evidence: "Phase 05 VERIFICATION.md confirms SATISFIED. Not listed in 05-01-SUMMARY requirements-completed frontmatter (field empty). Implementation verified."
    - id: "CAL-01"
      status: "partial"
      phase: "Phase 6"
      claimed_by_plans: ["06-01-PLAN.md"]
      completed_by_plans: []
      verification_status: "passed"
      evidence: "Phase 06 VERIFICATION.md confirms SATISFIED. Not listed in 06-01-SUMMARY requirements-completed frontmatter (field empty). Implementation verified."
    - id: "CAL-02"
      status: "partial"
      phase: "Phase 6"
      claimed_by_plans: ["06-01-PLAN.md"]
      completed_by_plans: []
      verification_status: "passed"
      evidence: "Phase 06 VERIFICATION.md confirms SATISFIED. Not listed in 06-01-SUMMARY requirements-completed frontmatter (field empty). Implementation verified."
    - id: "CAL-03"
      status: "partial"
      phase: "Phase 6"
      claimed_by_plans: ["06-01-PLAN.md"]
      completed_by_plans: []
      verification_status: "passed"
      evidence: "Phase 06 VERIFICATION.md confirms SATISFIED. Not listed in 06-01-SUMMARY requirements-completed frontmatter (field empty). Implementation verified."
  integration: []
  flows: []
tech_debt:
  - phase: 06-calendar-enhancements
    items:
      - "Dead export: CALENDAR_DOT_COLORS in src/lib/constants.ts (superseded by EVENT_TYPE_CONFIG, imported by zero files)"
  - phase: pre-existing
    items:
      - "Pre-existing TypeScript errors in unrelated files: convex/allocationActions.ts, convex/grants.ts, convex/newsletterActions.ts, convex/auth.ts, convex/seedPrograms.ts, convex/constantContactActions.ts"
---

# Milestone v1.1 "Polish" — Audit Report

**Audited:** 2026-02-28
**Status:** GAPS FOUND
**Root cause:** Phase 07 (Alert Configuration & Persistence) has no VERIFICATION.md — 3 ALRT requirements lack formal verification documentation.

## Executive Summary

All 8 requirements are **implemented and wired in the codebase** — the integration checker verified all cross-phase connections and 7/7 E2E flows are complete. The gap is a **documentation/process gap**: Phase 07 was never formally verified, so ALRT-01, ALRT-02, and ALRT-03 lack VERIFICATION.md evidence. Additionally, SUMMARY frontmatter `requirements-completed` fields are empty for Phases 5, 6, and 07-02 (tracking gap, not implementation gap).

## Scores

| Dimension | Score | Details |
|-----------|-------|---------|
| Requirements | 5/8 satisfied | 5 verified via VERIFICATION.md; 2 partial (ALRT-01/02 — SUMMARY listed but no verification); 1 unsatisfied (ALRT-03 — no verification, no SUMMARY) |
| Phases | 2/3 verified | Phase 05 PASSED, Phase 06 PASSED, Phase 07 UNVERIFIED |
| Integration | 8/8 wired | All requirement integration paths confirmed by checker |
| E2E Flows | 7/7 complete | All flows trace from data source through UI render |

---

## Phase Verification Status

| Phase | VERIFICATION.md | Status | Score |
|-------|-----------------|--------|-------|
| 05 — Dashboard KPI Trends | Present | PASSED | 5/5 truths verified |
| 06 — Calendar Enhancements | Present | PASSED | 8/8 truths verified |
| 07 — Alert Configuration & Persistence | **MISSING** | UNVERIFIED | — |

---

## 3-Source Requirements Cross-Reference

| REQ-ID | Description | VERIFICATION.md | SUMMARY Frontmatter | REQUIREMENTS.md | Final Status |
|--------|-------------|-----------------|---------------------|-----------------|--------------|
| DASH-01 | KPI trend arrows | SATISFIED (Ph 05) | not listed | [x] Complete | **satisfied** |
| DASH-02 | QB historical P&L trends | SATISFIED (Ph 05) | not listed | [x] Complete | **satisfied** |
| CAL-01 | Color-coded event types | SATISFIED (Ph 06) | not listed | [x] Complete | **satisfied** |
| CAL-02 | Countdown badges | SATISFIED (Ph 06) | not listed | [x] Complete | **satisfied** |
| CAL-03 | Imminent event toasts | SATISFIED (Ph 06) | not listed | [x] Complete | **satisfied** |
| ALRT-01 | Alert config admin tab + gear icon | **MISSING** | listed (07-01) | [x] Complete | **partial** |
| ALRT-02 | Dismissal persistence | **MISSING** | listed (07-01) | [x] Complete | **partial** |
| ALRT-03 | New alert toast notifications | **MISSING** | not listed | [x] Complete | **unsatisfied** |

### Strict Matrix Result

- **5 satisfied** — DASH-01, DASH-02, CAL-01, CAL-02, CAL-03 (VERIFICATION passed)
- **2 partial** — ALRT-01, ALRT-02 (no VERIFICATION, but SUMMARY lists them)
- **1 unsatisfied** — ALRT-03 (no VERIFICATION, not in SUMMARY)

**Orphaned requirements:** 0

### Integration Override Assessment

The integration checker independently verified **all 8 requirements** have working code paths. ALRT-03 is specifically confirmed: WhatNeedsAttention.tsx three-ref toast system (lines 97-131) fires warning toasts for critical alerts on first load and info toasts for newly-surfaced alerts on subsequent Convex updates. The gap is documentation, not implementation.

---

## Cross-Phase Integration

### Wiring Summary

| Check | Count | Status |
|-------|-------|--------|
| Connected exports | 12 | All wired |
| Orphaned exports | 1 | CALENDAR_DOT_COLORS (benign dead code) |
| Missing connections | 0 | — |
| Broken flows | 0 | — |
| Unprotected routes | 0 | — |

### E2E Flow Verification

| # | Flow | Requirements | Status |
|---|------|-------------|--------|
| 1 | QB cron → fetchPriorYearPnl → cache → getTrends → useTrends → ExecutiveSnapshot | DASH-01, DASH-02 | COMPLETE |
| 2 | EVENT_TYPE_CONFIG → classifyEventType → EventRow type badge | CAL-01 | COMPLETE |
| 3 | useState(now) + setInterval(60s) → formatCountdown → countdown badge | CAL-02 | COMPLETE |
| 4 | result data → useEffect → 30-60 min check → dedup ref → toast | CAL-03 | COMPLETE |
| 5 | admin ?tab=alerts → AlertsConfig → alertConfig.get/update → getAlerts reads thresholds | ALRT-01 | COMPLETE |
| 6 | dismiss button → alertDismissals.dismiss → getMyDismissals → visibleAlerts filter | ALRT-02 | COMPLETE |
| 7 | visibleAlerts changes → 3-ref dedup → toast(warning/info) | ALRT-03 | COMPLETE |

### Cross-Phase Observations

- **Toast system coexistence (CAL-03 + ALRT-03):** CalendarWidget and WhatNeedsAttention both use `useToast()` from the same ToastContext. No conflict — each maintains its own `useRef(Set)` dedup, and toasts from both sources stack in the shared queue with distinct IDs.
- **alertConfig.update RBAC:** Uses `requireRole(ctx, "admin", "manager")`. Non-admin roles can view the form via gear icon but server rejects their save attempts.
- **fetchPriorYearPnl sync position:** Called second in syncAllData after fetchProfitAndLoss. Both caches refresh every 15 minutes. getTrends gracefully returns null until both entries exist.

---

## Tech Debt

| Phase | Item | Severity |
|-------|------|----------|
| Phase 6 | `CALENDAR_DOT_COLORS` in constants.ts — dead export, zero importers | Low |
| Pre-existing | TypeScript errors in 6 unrelated Convex files | Low (not introduced by v1.1) |

**Total:** 2 items

---

## Human Verification Items (from Phase VERIFICATIONs)

### Phase 05
1. Trend arrows render with correct green/red color (QB connected)
2. Cash on Hand card has no trend badge
3. Skeleton-to-trend flash prevention on hard reload

### Phase 06
1. Event type badge colors render correctly in light/dark themes
2. Toast fires once per session per event (no re-fire on refetch)
3. Live countdown updates every 60 seconds
4. No errors in unconfigured state (no Google Calendar)

### Phase 07
- No human verification items — Phase 07 has no VERIFICATION.md

---

## Blocker

**Phase 07 requires VERIFICATION.md** — this is the single blocker preventing milestone audit from passing. Once Phase 07 is formally verified, all 8 requirements will have complete 3-source coverage and the milestone can be completed.

---

*Audited: 2026-02-28*
*Auditor: Claude (audit-milestone)*
