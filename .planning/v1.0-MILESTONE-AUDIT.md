---
milestone: v1.0
audited: 2026-02-28T13:00:00Z
status: gaps_found
scores:
  requirements: 18/22
  phases: 3/4
  integration: 18/18
  flows: 5/5
gaps:
  requirements:
    - id: "ALRT-01"
      status: "unsatisfied"
      phase: "Phase 4"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 4 (Proactive Alerts Panel) has no phase directory, no plans, no execution. Grant deadline alerts within 30 days not implemented as standalone alert type."
    - id: "ALRT-02"
      status: "unsatisfied"
      phase: "Phase 4"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "No budget variance query or threshold alert logic implemented. Phase 4 not started."
    - id: "ALRT-03"
      status: "unsatisfied"
      phase: "Phase 4"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "No stale-sync detection query. lastSyncAt fields exist in QB/Sheets/Calendar config tables but nothing reads them for staleness alerts. Phase 4 not started."
    - id: "ALRT-04"
      status: "unsatisfied"
      phase: "Phase 4"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "WhatNeedsAttention panel exists (Phase 2) but Phase 4 alert items have not been added to it. Phase 4 not started."
  integration: []
  flows: []
tech_debt:
  - phase: 02-dashboard-data-population
    items:
      - "INFO: Spinner on prefs === undefined in dashboard/page.tsx (acceptable — top-level preferences query, not section loading)"
      - "INFO: return null inside matchGrantToClass() in GrantBudget.tsx (not a stub — utility function no-match return)"
  - phase: 03-google-calendar-integration
    items:
      - "INFO: configuredBy: '' as any in googleCalendar.ts saveConfig (deliberate workaround matching Sheets singleton pattern)"
      - "Pre-existing: TS errors in allocationActions.ts, auth.ts, constantContactActions.ts (unrelated to any milestone phase)"
---

# Milestone v1.0 Audit Report — Command Center Milestone

**Audited:** 2026-02-28T13:00:00Z
**Status:** GAPS FOUND
**Score:** 18/22 requirements satisfied

---

## Executive Summary

Phases 1-3 of the Command Center Milestone are fully complete with all 18 requirements satisfied, all cross-phase integrations wired, and 5 E2E flows verified with zero breaks. Phase 4 (Proactive Alerts Panel) has not been started, leaving 4 ALRT requirements unsatisfied. No critical bugs or integration gaps exist in the completed work.

---

## Phase Status

| Phase | Name | Plans | Status | Requirements |
|-------|------|-------|--------|-------------|
| 1 | Newsletter Template Fix | 2/2 | PASSED | NEWS-01-04 (4/4) |
| 2 | Dashboard Data Population | 4/4 | PASSED (human_needed) | DASH-01-05, CMD-01-04 (9/9) |
| 3 | Google Calendar Integration | 3/3 | PASSED | CAL-01-05 (5/5) |
| 4 | Proactive Alerts Panel | 0/2 | NOT STARTED | ALRT-01-04 (0/4) |

---

## Requirements Coverage (3-Source Cross-Reference)

### Satisfied (18/22)

#### Phase 1: Newsletter Template Fix

| REQ-ID | Description | VERIFICATION | SUMMARY | REQUIREMENTS | Final |
|--------|-------------|-------------|---------|--------------|-------|
| NEWS-01 | Table-based layout for cross-client compatibility | SATISFIED | 01-01 | [x] | **satisfied** |
| NEWS-02 | All CSS inlined, no unsupported properties | SATISFIED | 01-01 | [x] | **satisfied** |
| NEWS-03 | Content size validation, 400KB warning | SATISFIED | 01-02 | [x] | **satisfied** |
| NEWS-04 | Preview accuracy reflects email rendering | SATISFIED | 01-02 | [x] | **satisfied** |

#### Phase 2: Dashboard Data Population

| REQ-ID | Description | VERIFICATION | SUMMARY | REQUIREMENTS | Final |
|--------|-------------|-------------|---------|--------------|-------|
| DASH-01 | KPI cards render live QB data | SATISFIED | 02-01, 02-04 | [x] | **satisfied** |
| DASH-02 | Charts render with real data | SATISFIED | 02-04 | [x] | **satisfied** |
| DASH-03 | 3-state loading (skeleton/prompt/data) | SATISFIED | 02-04 | [x] | **satisfied** |
| DASH-04 | Grant tracking with status/deadlines | SATISFIED | — * | [x] | **satisfied** |
| DASH-05 | Program demographics from Sheets | SATISFIED | — * | [x] | **satisfied** |
| CMD-01 | Financial snapshot section | SATISFIED | 02-01, 02-04 | [x] | **satisfied** |
| CMD-02 | Client activity section | SATISFIED | 02-01 | [x] | **satisfied** |
| CMD-03 | "What Needs Attention" panel | SATISFIED | — * | [x] | **satisfied** |
| CMD-04 | Sections load independently | SATISFIED | — * | [x] | **satisfied** |

\* SUMMARY frontmatter omission — documentation gap only. VERIFICATION evidence and integration checker both confirm full implementation with concrete code-level evidence.

#### Phase 3: Google Calendar Integration

| REQ-ID | Description | VERIFICATION | SUMMARY | REQUIREMENTS | Final |
|--------|-------------|-------------|---------|--------------|-------|
| CAL-01 | Events sync via service account | SATISFIED | — * | [x] | **satisfied** |
| CAL-02 | Cron sync at 30min default | SATISFIED | 03-02 | [x] | **satisfied** |
| CAL-03 | Admin configures calendar IDs | SATISFIED | 03-02 | [x] | **satisfied** |
| CAL-04 | Widget shows today + next 7 days | SATISFIED | 03-03 | [x] | **satisfied** |
| CAL-05 | Events show title, time, source | SATISFIED | 03-03 | [x] | **satisfied** |

\* SUMMARY frontmatter omission — documentation gap only.

### Unsatisfied (4/22)

| REQ-ID | Phase | Description | Reason |
|--------|-------|-------------|--------|
| ALRT-01 | 4 | Grant deadline alerts within 30 days | Phase 4 not started |
| ALRT-02 | 4 | Budget variance alerts on spending threshold | Phase 4 not started |
| ALRT-03 | 4 | Sync status alerts for stale QB/Sheets data | Phase 4 not started |
| ALRT-04 | 4 | Alerts display in "What Needs Attention" panel | Phase 4 not started |

### Orphan Detection

No orphaned requirements. All 22 requirements in the traceability table are assigned to phases. ALRT-01-04 are assigned to Phase 4, which has not been executed — they are unsatisfied, not orphaned.

---

## Integration Check Results

**Integration Checker Status:** All completed phases fully wired

| Check | Result |
|-------|--------|
| Cross-phase wiring | 9 integration points verified — all WIRED |
| E2E flows | 5/5 complete, 0 broken |
| Orphaned exports | 0 |
| Missing connections | 0 (within completed phases) |
| Unprotected routes | 0 |

### Verified E2E Flows

1. **Admin → Calendar → Dashboard**: Admin configures calendar IDs → cron syncs → CalendarWidget renders agenda list
2. **Grant deadlines → Attention panel**: Grants table → getUpcomingDeadlines → WhatNeedsAttention renders items
3. **QB sync → Executive Snapshot → tooltip**: QB cron → cache → 3 KPI cards with formatDollars + hover tooltip
4. **Newsletter generation → size check → preview**: buildNewsletterHtml → juice → OpenAI polish → size badge → iframe
5. **Client stats → ClientActivity section**: getStats + getStatsByProgram → 3-card grid with program badges

### Key Cross-Phase Integrations

- Phase 3 CalendarWidget adopts Phase 2 three-state loading pattern (DASH-03 extension)
- Phase 3 CalendarWidget registered in Phase 2 reorderable section system (SECTION_COMPONENTS + DashboardSectionId)
- Phase 3 reuses Phase 2 `timeAgo` utility in GoogleCalendarConfig admin tab
- Phase 3 reuses Google Sheets service account credentials (same env vars)
- Phase 3 cron registered alongside existing QB (15min) and Sheets (30min) crons
- CMD-03 WhatNeedsAttention panel (Phase 2) is the foundation for Phase 4 alert items

---

## Tech Debt

### Phase 2: Dashboard Data Population
- **INFO:** Spinner on `prefs === undefined` in `dashboard/page.tsx` lines 134-143 (acceptable — top-level preferences query, extremely fast Convex cache load)
- **INFO:** `return null` inside `matchGrantToClass()` in `GrantBudget.tsx` line 42 (not a stub — utility function no-match return)

### Phase 3: Google Calendar Integration
- **INFO:** `configuredBy: "" as any` in `googleCalendar.ts` saveConfig mutation line 54 (deliberate workaround matching Sheets singleton pattern)
- **Pre-existing:** TypeScript errors in `allocationActions.ts`, `auth.ts`, `constantContactActions.ts` (unrelated to any milestone phase)

### Total: 3 INFO items + 1 pre-existing issue across 2 phases — no actionable debt

---

## Human Verification Items (from phase verifications)

These are runtime behavior checks that passed code-level verification but require browser confirmation:

### Phase 1
1. Email client rendering fidelity (send test email to Gmail)

### Phase 2
1. Skeleton shimmer timing during page load
2. Hover tooltip on financial values
3. QB disconnected state rendering
4. Google Sheets disconnected state rendering
5. WhatNeedsAttention count badge accuracy

### Phase 3
1. Dashboard calendar widget live rendering (three-state)
2. Admin Google Calendar tab CRUD interaction
3. Calendar widget with live Google Calendar data (optional — requires GCal setup)

---

## Conclusion

The milestone is **not complete**. Phases 1-3 are fully delivered with strong verification evidence, clean cross-phase integration, and zero critical issues. Phase 4 (Proactive Alerts Panel) has not been started, leaving ALRT-01 through ALRT-04 unsatisfied.

**Note:** Phase 2 already built the `WhatNeedsAttention` panel (CMD-03) with grant deadline items and QB connection warnings. Phase 4 would extend this panel with budget variance alerts (ALRT-02) and sync staleness detection (ALRT-03). The foundation is in place — Phase 4 adds computed alert logic, not new UI infrastructure.

---

_Audited: 2026-02-28T13:00:00Z_
_Auditor: Claude (gsd-audit-milestone)_
